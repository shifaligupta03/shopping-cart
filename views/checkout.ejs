<% include layouts/header %>
<% if(cart && cart.length){%>
    <h1 class="page-title"> My Cart</h1>
    <table class="table table-striped alignmiddle">
        <tr>
            <th>Image</th>
            <th>Title</th>
            <th>Price</th>
            <th>Quantity</th>
            <th></th>
            <th>Subtotal</th>
        </tr>

        <% let total=0 %>
        <% cart.forEach(function(product){  %>
            <% let sub=parseFloat(product.qty * product.price).toFixed(2) %>
            <% total =  parseFloat(total)+parseFloat(sub) %>
            <tr>
                <td><img class="productImg" src="<%= product.image %>" ></td>
                <td><%= product.title %></td>
                <td><%= product.price %></td>
                <td><%= product.qty %></td>
                <td>
                    <a href="/cart/update/<%= product.title %>?action=add">+</a>&nbsp;
                    <a href="/cart/update/<%= product.title %>?action=remove">-</a>&nbsp;
                    <a href="/cart/update/<%= product.title %>?action=clear">clear</a>&nbsp;
                </td>
                <td><%= sub %></td>
            </tr>
        <% })  %>
        <tr>
            <td colspan="6" align="right"> <b>Total: </b> <%= parseFloat(total).toFixed(2)%></td>
        </tr>
        <tr>
            <td colspan="5" align="right">
                <a class="btn btn-danger" href="/cart/clear"> Clear cart</a>
            </td>
            <td colspan="5" align="right">
                <a class="btn btn-primary buynow" href="#"> Buy Now</a>
            </td>
        </tr>

    </table>
<% } else{ %>
    <h3> Your cart is empty</h3>
<% } %>

<% include layouts/footer %>